---
import Layout from "./Layout.astro";

interface Props {
  frontmatter: {
    title: string;
    description: string;
    pubDate: Date | string;
    updatedDate?: Date | string;
    heroImage?: string;
    tags?: string[];
  };
}

const { frontmatter } = Astro.props;
const { title, description, pubDate, updatedDate, heroImage, tags = [] } = frontmatter;

const formattedPubDate = new Date(pubDate).toLocaleDateString('en-IE', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const formattedUpdatedDate = updatedDate 
  ? new Date(updatedDate).toLocaleDateString('en-IE', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    })
  : null;
---

<Layout title={title} description={description} image={heroImage}>
  <article class="container py-8 md:py-12">
    
    <!-- Back link -->
    <a href="/blog/" class="btn btn-ghost text-xs mb-6 inline-flex">
      ← Back to blog
    </a>

    <!-- Article Header -->
    <header class="max-w-3xl mb-8">
      <h1 class="text-3xl md:text-4xl font-semibold text-[var(--color-text-primary)] leading-tight">
        {title}
      </h1>
      
      <p class="text-lg text-[var(--color-text-secondary)] mt-4">
        {description}
      </p>
      
      <div class="flex flex-wrap items-center gap-3 mt-6 text-sm">
        <time 
          datetime={new Date(pubDate).toISOString()} 
          class="font-mono text-[var(--color-text-muted)]"
        >
          {formattedPubDate}
        </time>
        
        {formattedUpdatedDate && (
          <>
            <span class="text-[var(--color-text-dimmed)]">·</span>
            <span class="text-[var(--color-text-muted)]">
              Updated {formattedUpdatedDate}
            </span>
          </>
        )}
        
        {tags.length > 0 && (
          <>
            <span class="text-[var(--color-text-dimmed)]">·</span>
            <div class="flex gap-2">
              {tags.map(tag => (
                <span class="badge">{tag}</span>
              ))}
            </div>
          </>
        )}
      </div>
    </header>

    <!-- Hero Image -->
    {heroImage && (
      <figure class="mb-10 max-w-4xl">
        <img 
          src={heroImage} 
          alt={title}
          class="w-full rounded-lg border border-[var(--color-border)]"
          loading="eager"
        />
      </figure>
    )}

    <!-- Article Content -->
    <div class="prose max-w-3xl">
      <slot />
    </div>

    <!-- Article Footer -->
    <footer class="max-w-3xl mt-12 pt-8 border-t border-[var(--color-border)]">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
          <p class="text-sm text-[var(--color-text-muted)]">
            Thanks for reading! Feel free to reach out if you have questions.
          </p>
        </div>
        <div class="flex gap-2">
          <a 
            href="https://x.com/BMcWeeneyIE" 
            target="_blank" 
            rel="noopener noreferrer"
            class="btn btn-ghost text-xs"
          >
            Share on X
          </a>
          <a href="/blog/" class="btn text-xs">
            More posts →
          </a>
        </div>
      </div>
    </footer>

  </article>
</Layout>