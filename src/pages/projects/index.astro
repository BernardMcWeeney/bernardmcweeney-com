---
import RackLayout from "../../layouts/RackLayout.astro";

// You can replace this with a content collection when ready
const projects = [
  {
    name: "bernardmcweeney.com",
    status: "active",
    description: "Personal website built with Astro and the Rack theme",
    tech: ["Astro", "Tailwind", "Cloudflare"],
    link: "https://bernardmcweeney.com",
  },
  {
    name: "Greenberry",
    status: "active",
    description: "Web development and IT services for Irish businesses",
    tech: ["WordPress", "React", "Azure"],
    link: "https://greenberry.ie",
  },
  {
    name: "Parish Core",
    status: "development",
    description: "WordPress plugin for Catholic parish management",
    tech: ["WordPress", "PHP", "React"],
    link: null,
  },
  {
    name: "Cureation",
    status: "planned",
    description: "Fan site dedicated to The Cure",
    tech: ["Astro", "Tailwind"],
    link: null,
  },
];

const statusConfig = {
  active: { label: "RUNNING", badge: "badge-green", led: "on" },
  development: { label: "BUILDING", badge: "badge-amber", led: "amber blink" },
  planned: { label: "PLANNED", badge: "", led: "" },
  archived: { label: "STOPPED", badge: "badge-red", led: "red" },
};
---

<RackLayout 
  title="Projects" 
  description="Active services and projects by Bernard McWeeney"
>
  <!-- Header -->
  <div class="blade" data-unit="1U">
    <div class="blade-face">
      <div class="led-cluster">
        <span class="led on"></span>
        <span class="led on"></span>
        <span class="led amber blink"></span>
      </div>
      <span class="blade-label">
        SERVICES
        <span class="model">systemctl list-units --type=service --all</span>
      </span>
    </div>
  </div>

  <!-- Terminal Header -->
  <div class="blade" data-unit="1U">
    <div class="blade-content" style="padding: 0.75rem;">
      <div class="terminal" style="border: none; background: transparent;">
        <div class="terminal-line">
          <span class="prompt">[bernard@srv01 ~]$</span>
          <span class="command">systemctl status --all</span>
        </div>
        <div class="terminal-line">
          <span class="output muted">{projects.length} services loaded</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Projects List -->
  <div class="blade" data-unit="3U">
    <div class="blade-content">
      <div class="services-list stagger">
        {projects.map((project) => {
          const config = statusConfig[project.status as keyof typeof statusConfig];
          return (
            <div class="service-row">
              <div class="service-status">
                <span class={`led ${config.led}`}></span>
              </div>
              <div class="service-info">
                <div class="service-header">
                  <span class="service-name">{project.name}.service</span>
                  <span class={`badge ${config.badge}`}>{config.label}</span>
                </div>
                <div class="service-desc">{project.description}</div>
                <div class="service-tech">
                  {project.tech.map(t => (
                    <span class="tech-badge">{t}</span>
                  ))}
                </div>
              </div>
              <div class="service-actions">
                {project.link ? (
                  <a href={project.link} target="_blank" rel="noopener" class="btn btn-sm">
                    Visit â†—
                  </a>
                ) : (
                  <span class="btn btn-sm" style="opacity: 0.5; pointer-events: none;">
                    --
                  </span>
                )}
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </div>

  <!-- Status Summary -->
  <div class="blade" data-unit="1U">
    <div class="blade-content">
      <div class="status-summary">
        <div class="summary-item">
          <span class="led on"></span>
          <span class="summary-count">{projects.filter(p => p.status === 'active').length}</span>
          <span class="summary-label">Active</span>
        </div>
        <div class="summary-item">
          <span class="led amber blink"></span>
          <span class="summary-count">{projects.filter(p => p.status === 'development').length}</span>
          <span class="summary-label">In Development</span>
        </div>
        <div class="summary-item">
          <span class="led"></span>
          <span class="summary-count">{projects.filter(p => p.status === 'planned').length}</span>
          <span class="summary-label">Planned</span>
        </div>
      </div>
    </div>
  </div>
</RackLayout>

<style>
  .services-list {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .service-row {
    display: grid;
    grid-template-columns: 30px 1fr auto;
    gap: 1rem;
    padding: 0.75rem;
    background: var(--color-panel);
    border: 1px solid var(--color-border);
    transition: all 0.15s ease;
  }

  .service-row:hover {
    border-color: var(--color-border-bright);
  }

  .service-status {
    display: flex;
    align-items: flex-start;
    padding-top: 0.25rem;
  }

  .service-status .led {
    width: 8px;
    height: 8px;
  }

  .service-info {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
  }

  .service-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex-wrap: wrap;
  }

  .service-name {
    font-size: 13px;
    font-weight: 600;
    color: var(--color-term-white);
  }

  .service-desc {
    font-size: 12px;
    color: var(--color-term-gray);
  }

  .service-tech {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 0.25rem;
  }

  .tech-badge {
    padding: 0.1rem 0.35rem;
    font-size: 9px;
    background: var(--color-chassis);
    border: 1px solid var(--color-border);
    color: var(--color-term-cyan);
  }

  .service-actions {
    display: flex;
    align-items: flex-start;
  }

  /* Status Summary */
  .status-summary {
    display: flex;
    gap: 2rem;
    flex-wrap: wrap;
  }

  .summary-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .summary-item .led {
    width: 6px;
    height: 6px;
  }

  .summary-count {
    font-size: 16px;
    font-weight: 700;
    color: var(--color-term-green);
  }

  .summary-label {
    font-size: 11px;
    color: var(--color-term-dark);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
</style>