---
import Layout from "../layouts/Layout.astro";
import yaml from "js-yaml";
import fs from "node:fs";
import path from "node:path";

const aboutPath = path.join(process.cwd(), "src/data/about.yaml");
const aboutData = yaml.load(fs.readFileSync(aboutPath, "utf8")) as {
  title: string;
  subtitle: string;
  story: {
    title: string;
    paragraphs: string[];
  };
  skills: {
    intro: string;
    categories: {
      name: string;
      description: string;
      items: string[];
    }[];
  };
  interests: {
    intro: string;
    items: string[];
    footer: string;
  };
  contact: {
    intro: string;
    cta: string;
    email: string;
    linkedin: string;
    github: string;
  };
};
---

<Layout
  title="About"
  description="A bit about Bernard McWeeney - tech enthusiast from Meath, Ireland, now based in Dublin."
>
  <div class="container">
    <header class="page-header">
      <h1>{aboutData.title}</h1>
      <p>{aboutData.subtitle}</p>
    </header>

    <div class="about-content">
      <section class="about-section">
        <div class="card story-card">
          <h2>{aboutData.story.title}</h2>
          <div class="prose">
            {aboutData.story.paragraphs.map((paragraph, index) => (
              index === 2 ? (
                <p>
                  Outside of that, I build websites and web applications. I started
                  <a href="/projects/greenberry">Greenberry</a> to help Irish small businesses
                  get online without being ripped off. There's a lot of overpriced, overcomplicated
                  solutions out there, and I thought I could do better. The jury's still out on
                  whether I was right.
                </p>
              ) : (
                <p>{paragraph}</p>
              )
            ))}
          </div>
        </div>
      </section>

      <section class="about-section">
        <h2>What I Work With</h2>
        <p class="section-intro">{aboutData.skills.intro}</p>

        <div class="skills-cards">
          {aboutData.skills.categories.map((category) => (
            <div class="card">
              <h3>{category.name}</h3>
              <p class="skills-description">{category.description}</p>
              <div class="skills-grid">
                {category.items.map((skill) => (
                  <span class="skill-tag">{skill}</span>
                ))}
              </div>
            </div>
          ))}
        </div>
      </section>

      <section class="about-section">
        <h2>Beyond the Code</h2>
        <div class="card">
          <p style="margin-bottom: 1rem; color: var(--color-text);">
            {aboutData.interests.intro}
          </p>
          <ul class="interests-list">
            {aboutData.interests.items.map((interest) => (
              <li>{interest}</li>
            ))}
          </ul>
          <p style="margin-top: 1rem; color: var(--color-text-muted); font-style: italic;">
            {aboutData.interests.footer}
          </p>
        </div>
      </section>

      <section class="about-section">
        <h2>Get in Touch</h2>
        <div class="card contact-card">
          <p>
            {aboutData.contact.intro.split("Disintegration")[0]}
            <em>Disintegration</em>
            {aboutData.contact.intro.split("Disintegration")[1]}
          </p>
          <p>{aboutData.contact.cta}</p>
          <div class="contact-links">
            <a href={`mailto:${aboutData.contact.email}`} class="btn btn-primary">
              Drop Me an Email
            </a>
            <a href={aboutData.contact.linkedin} target="_blank" rel="noopener" class="btn">
              LinkedIn
            </a>
            <a href={aboutData.contact.github} target="_blank" rel="noopener" class="btn">
              GitHub
            </a>
          </div>
        </div>
      </section>
    </div>
  </div>
</Layout>

<style>
  .story-card {
    padding: 2.5rem;
  }

  .story-card h2 {
    margin-bottom: 1.5rem;
  }

  .section-intro {
    color: var(--color-text-muted);
    margin-bottom: 1.5rem;
  }

  .skills-cards {
    display: grid;
    gap: 1.5rem;
  }

  .skills-cards h3 {
    color: var(--color-sky-dark);
    margin-bottom: 0.5rem;
  }

  .dark .skills-cards h3 {
    color: var(--color-sky);
  }

  .skills-description {
    font-size: 0.9rem;
    color: var(--color-text-muted);
    margin-bottom: 1rem;
  }

  .interests-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }

  .interests-list li {
    padding: 0.5rem 1rem;
    background: var(--color-sky-light);
    border-radius: 9999px;
    font-size: 0.9rem;
    color: var(--color-sky-dark);
  }

  .dark .interests-list li {
    background: rgba(14, 165, 233, 0.2);
    color: var(--color-sky);
  }

  .contact-card {
    padding: 2rem;
  }

  .contact-card p {
    color: var(--color-text);
    margin-bottom: 1rem;
    line-height: 1.7;
  }

  .contact-card p:last-of-type {
    margin-bottom: 1.5rem;
  }

  .contact-links {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }

  @media (min-width: 768px) {
    .skills-cards {
      grid-template-columns: repeat(3, 1fr);
    }
  }
</style>
