---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout
  title="Blog"
  description="Thoughts on web development, IT infrastructure, and technology from Bernard McWeeney."
>
  <div class="container">
    <header class="page-header">
      <h1>Blog</h1>
      <p>Thoughts on web development, IT infrastructure, and technology.</p>
    </header>

    <section class="section" style="padding-top: 0;">
      <div class="grid grid-2">
        {posts.map((post) => (
          <a href={`/blog/${post.slug}`} class="card card-link">
            <article class="post-card">
              <time class="post-date" datetime={post.data.pubDate.toISOString()}>
                {post.data.pubDate.toLocaleDateString("en-IE", {
                  year: "numeric",
                  month: "long",
                  day: "numeric",
                })}
              </time>
              <h3 class="post-title">{post.data.title}</h3>
              <p class="post-excerpt">{post.data.description}</p>
              {post.data.tags && (
                <div class="post-tags">
                  {post.data.tags.map((tag) => (
                    <span class="tag">{tag}</span>
                  ))}
                </div>
              )}
            </article>
          </a>
        ))}
      </div>
    </section>
  </div>
</Layout>
