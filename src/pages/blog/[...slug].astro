---
import Layout from "../../layouts/Layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: post,
  }));
}

const post = Astro.props;
const { Content } = await render(post);
---

<Layout title={post.data.title} description={post.data.description}>
  <article class="container" style="padding-top: 2rem; padding-bottom: 4rem;">
    <header class="article-header">
      <h1>{post.data.title}</h1>
      <div class="article-meta">
        <time datetime={post.data.pubDate.toISOString()}>
          {post.data.pubDate.toLocaleDateString("en-IE", {
            year: "numeric",
            month: "long",
            day: "numeric",
          })}
        </time>
        {post.data.tags && (
          <div class="post-tags">
            {post.data.tags.map((tag) => (
              <span class="tag">{tag}</span>
            ))}
          </div>
        )}
      </div>
    </header>
    <div class="prose">
      <Content />
    </div>
    <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--color-border);">
      <a href="/blog" class="btn">&larr; Back to Blog</a>
    </div>
  </article>
</Layout>
