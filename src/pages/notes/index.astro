---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

// Try to get notes if the collection exists
let notes: any[] = [];
try {
  notes = (await getCollection("notes")).filter((p: any) => !p.data?.draft);
  notes.sort((a: any, b: any) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf());
} catch {
  // Collection doesn't exist yet
}
---

<Layout 
  title="Notes" 
  description="Quick thoughts, snippets, and TILs."
>
  <div class="container py-8 md:py-12">
    
    <!-- Page Header -->
    <header class="mb-10">
      <h1 class="text-3xl md:text-4xl font-semibold text-[var(--color-text-primary)]">
        Notes
      </h1>
      <p class="text-[var(--color-text-secondary)] mt-2 max-w-2xl">
        Quick thoughts, snippets, and things I've learned. Less polished than blog posts, 
        but hopefully still useful.
      </p>
    </header>

    <!-- Notes List -->
    {notes.length === 0 ? (
      <div class="card p-8 text-center">
        <p class="text-[var(--color-text-muted)]">
          No notes yet. This section is for quick thoughts and TILs â€” coming soon!
        </p>
      </div>
    ) : (
      <div class="space-y-3">
        {notes.map(note => {
          const date = new Date(note.data.date).toLocaleDateString('en-IE', {
            year: 'numeric',
            month: 'short',
            day: 'numeric',
          });
          return (
            <a 
              href={`/notes/${note.slug}/`}
              class="card card-interactive block p-4"
            >
              <div class="flex items-start justify-between gap-4">
                <div>
                  <h2 class="font-mono text-base font-medium text-[var(--color-text-primary)]">
                    {note.data.title}
                  </h2>
                  {note.data.description && (
                    <p class="text-sm text-[var(--color-text-muted)] mt-1">
                      {note.data.description}
                    </p>
                  )}
                </div>
                <span class="text-xs font-mono text-[var(--color-text-dimmed)] flex-shrink-0">
                  {date}
                </span>
              </div>
            </a>
          );
        })}
      </div>
    )}

  </div>
</Layout>